<svg viewBox="0 0 960 520" fill="none" xmlns="http://www.w3.org/2000/svg" font-family="Inter,system-ui,sans-serif">
  <defs>
    <marker id="arrowOrange" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0,0 10,3.5 0,7" fill="#F47B20"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="480" y="30" text-anchor="middle" fill="#e8e6e3" font-size="18" font-weight="600">Logical Device Layout of a Resource</text>
  <text x="480" y="50" text-anchor="middle" fill="#9ca3af" font-size="12">How SirixDB stores versioned data on disk using two append-only files</text>

  <!-- ============================================ -->
  <!-- LD₂ &#8212; UberPage (Revision Index)        -->
  <!-- ============================================ -->

  <!-- LD₂ label -->
  <rect x="30" y="80" width="50" height="80" rx="8" fill="rgba(156,163,175,0.08)" stroke="#6b7280" stroke-width="1.5"/>
  <text x="55" y="117" text-anchor="middle" fill="#9ca3af" font-size="14" font-family="JetBrains Mono,monospace" font-weight="600">LD₂</text>

  <!-- LD₂ subtitle -->
  <text x="55" y="178" text-anchor="middle" fill="#6b7280" font-size="10">UberPage</text>

  <!-- LD₂ timeline -->
  <line x1="100" y1="120" x2="900" y2="120" stroke="#6b7280" stroke-width="1" stroke-dasharray="4,3"/>

  <!-- Densely packed UberPage entries (no block alignment) -->

  <!-- UberPage slot: Rev 1 -->
  <rect x="130" y="90" width="70" height="60" rx="5" fill="rgba(244,123,32,0.35)" stroke="#F47B20" stroke-width="1.2"/>
  <text x="165" y="110" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">TSP₁</text>
  <text x="165" y="126" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">OFFS₁</text>
  <text x="165" y="143" text-anchor="middle" fill="#9ca3af" font-size="9">rev 1</text>

  <!-- UberPage slot: Rev 2 (packed tight) -->
  <rect x="200" y="90" width="70" height="60" rx="5" fill="rgba(244,123,32,0.35)" stroke="#F47B20" stroke-width="1.2"/>
  <text x="235" y="110" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">TSP₂</text>
  <text x="235" y="126" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">OFFS₂</text>
  <text x="235" y="143" text-anchor="middle" fill="#9ca3af" font-size="9">rev 2</text>

  <!-- UberPage slot: Rev 3 (packed tight) -->
  <rect x="270" y="90" width="70" height="60" rx="5" fill="rgba(244,123,32,0.35)" stroke="#F47B20" stroke-width="1.2"/>
  <text x="305" y="110" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">TSP₃</text>
  <text x="305" y="126" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">OFFS₃</text>
  <text x="305" y="143" text-anchor="middle" fill="#9ca3af" font-size="9">rev 3</text>

  <!-- Ellipsis -->
  <text x="365" y="125" fill="#6b7280" font-size="20" text-anchor="middle">...</text>

  <!-- "densely packed" annotation -->
  <text x="235" y="168" text-anchor="middle" fill="#6b7280" font-size="9" font-style="italic">densely packed (no block alignment)</text>

  <!-- ============================================ -->
  <!-- LD₁ &#8212; Data Pages + UberPage copy       -->
  <!-- ============================================ -->

  <!-- LD₁ label -->
  <rect x="30" y="220" width="50" height="140" rx="8" fill="rgba(156,163,175,0.08)" stroke="#6b7280" stroke-width="1.5"/>
  <text x="55" y="295" text-anchor="middle" fill="#9ca3af" font-size="14" font-family="JetBrains Mono,monospace" font-weight="600">LD₁</text>

  <!-- LD₁ subtitle -->
  <text x="55" y="378" text-anchor="middle" fill="#6b7280" font-size="10">Data +</text>
  <text x="55" y="390" text-anchor="middle" fill="#6b7280" font-size="10">UberPage</text>

  <!-- LD₁ timeline -->
  <line x1="100" y1="290" x2="900" y2="290" stroke="#6b7280" stroke-width="1" stroke-dasharray="4,3"/>

  <!-- === Revision 1 === -->

  <!-- PF₁,₁ -->
  <rect x="110" y="255" width="75" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="148" y="271" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PF₁,₁</text>
  <text x="148" y="285" text-anchor="middle" fill="#6b7280" font-size="9">IndirPage</text>

  <!-- PF₂,₁ -->
  <rect x="195" y="255" width="75" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="233" y="271" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PF₂,₁</text>
  <text x="233" y="285" text-anchor="middle" fill="#6b7280" font-size="9">RecordPage</text>

  <!-- ... -->
  <text x="284" y="277" fill="#42B6F0" font-size="14" text-anchor="middle" opacity="0.5">...</text>

  <!-- PFₙ,₁ -->
  <rect x="298" y="255" width="75" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="336" y="271" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PFₙ,₁</text>
  <text x="336" y="285" text-anchor="middle" fill="#6b7280" font-size="9">NamePage</text>

  <!-- RRP₁ -->
  <rect x="383" y="249" width="60" height="48" rx="6" fill="rgba(244,123,32,0.55)" stroke="#F47B20" stroke-width="1.5"/>
  <text x="413" y="271" text-anchor="middle" fill="#F47B20" font-size="11" font-family="JetBrains Mono,monospace" font-weight="700">RRP</text>
  <text x="413" y="287" text-anchor="middle" fill="#e8e6e3" font-size="9">rev 1</text>

  <!-- === Revision 2 === -->

  <!-- PF₁,₂ -->
  <rect x="460" y="255" width="75" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="498" y="271" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PF₁,₂</text>
  <text x="498" y="285" text-anchor="middle" fill="#6b7280" font-size="9">RecordPage</text>

  <!-- ... -->
  <text x="549" y="277" fill="#42B6F0" font-size="14" text-anchor="middle" opacity="0.5">...</text>

  <!-- PF₂,₂ -->
  <rect x="563" y="255" width="75" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="601" y="271" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PF₂,₂</text>
  <text x="601" y="285" text-anchor="middle" fill="#6b7280" font-size="9">PathPage</text>

  <!-- RRP₂ -->
  <rect x="648" y="249" width="60" height="48" rx="6" fill="rgba(244,123,32,0.55)" stroke="#F47B20" stroke-width="1.5"/>
  <text x="678" y="271" text-anchor="middle" fill="#F47B20" font-size="11" font-family="JetBrains Mono,monospace" font-weight="700">RRP</text>
  <text x="678" y="287" text-anchor="middle" fill="#e8e6e3" font-size="9">rev 2</text>

  <!-- === Revision 3 === -->

  <!-- PF₁,₃ -->
  <rect x="725" y="255" width="75" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="763" y="271" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PF₁,₃</text>
  <text x="763" y="285" text-anchor="middle" fill="#6b7280" font-size="9">RecordPage</text>

  <!-- RRP₃ -->
  <rect x="810" y="249" width="60" height="48" rx="6" fill="rgba(244,123,32,0.55)" stroke="#F47B20" stroke-width="1.5"/>
  <text x="840" y="271" text-anchor="middle" fill="#F47B20" font-size="11" font-family="JetBrains Mono,monospace" font-weight="700">RRP</text>
  <text x="840" y="287" text-anchor="middle" fill="#e8e6e3" font-size="9">rev 3</text>

  <!-- Continuation -->
  <text x="890" y="277" fill="#6b7280" font-size="20" text-anchor="middle">...</text>

  <!-- Block size bracket for LD₁ -->
  <line x1="110" y1="297" x2="110" y2="305" stroke="#6b7280" stroke-width="0.8"/>
  <line x1="110" y1="305" x2="185" y2="305" stroke="#6b7280" stroke-width="0.8"/>
  <line x1="185" y1="297" x2="185" y2="305" stroke="#6b7280" stroke-width="0.8"/>
  <text x="148" y="317" text-anchor="middle" fill="#6b7280" font-size="9" font-family="JetBrains Mono,monospace">Blk</text>

  <!-- UberPage copy in LD₁ (after all revision data) -->
  <rect x="110" y="330" width="180" height="28" rx="5" fill="rgba(244,123,32,0.2)" stroke="#F47B20" stroke-width="1" stroke-dasharray="3,2"/>
  <text x="200" y="348" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">UberPage (copy)</text>
  <text x="310" y="348" fill="#6b7280" font-size="9" font-style="italic">&#8592; stored redundantly in both files</text>

  <!-- === Offset arrows from LD₂ to LD₁ === -->

  <!-- Rev 1: OFFS₁ → RRP₁ -->
  <path d="M 165 150 L 165 205 Q 165 215 175 215 L 403 215 Q 413 215 413 225 L 413 249"
        fill="none" stroke="#F47B20" stroke-width="1.2" stroke-dasharray="4,2" marker-end="url(#arrowOrange)"/>

  <!-- Rev 2: OFFS₂ → RRP₂ -->
  <path d="M 235 150 L 235 200 Q 235 210 245 210 L 668 210 Q 678 210 678 220 L 678 249"
        fill="none" stroke="#F47B20" stroke-width="1.2" stroke-dasharray="4,2" marker-end="url(#arrowOrange)"/>

  <!-- Rev 3: OFFS₃ → RRP₃ -->
  <path d="M 305 150 L 305 195 Q 305 205 315 205 L 830 205 Q 840 205 840 215 L 840 249"
        fill="none" stroke="#F47B20" stroke-width="1.2" stroke-dasharray="4,2" marker-end="url(#arrowOrange)"/>

  <!-- === Revision brackets === -->

  <!-- R₁ bracket -->
  <line x1="110" y1="400" x2="443" y2="400" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="110" y1="395" x2="110" y2="405" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="443" y1="395" x2="443" y2="405" stroke="#42B6F0" stroke-width="1.5"/>
  <text x="277" y="420" text-anchor="middle" fill="#42B6F0" font-size="13" font-family="JetBrains Mono,monospace" font-weight="600">R₁</text>

  <!-- R₂ bracket -->
  <line x1="460" y1="400" x2="708" y2="400" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="460" y1="395" x2="460" y2="405" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="708" y1="395" x2="708" y2="405" stroke="#42B6F0" stroke-width="1.5"/>
  <text x="584" y="420" text-anchor="middle" fill="#42B6F0" font-size="13" font-family="JetBrains Mono,monospace" font-weight="600">R₂</text>

  <!-- R₃ bracket -->
  <line x1="725" y1="400" x2="870" y2="400" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="725" y1="395" x2="725" y2="405" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="870" y1="395" x2="870" y2="405" stroke="#42B6F0" stroke-width="1.5"/>
  <text x="798" y="420" text-anchor="middle" fill="#42B6F0" font-size="13" font-family="JetBrains Mono,monospace" font-weight="600">R₃</text>

  <!-- === Legend === -->

  <rect x="130" y="450" width="18" height="10" rx="3" fill="rgba(244,123,32,0.55)" stroke="#F47B20" stroke-width="0.8"/>
  <text x="156" y="460" fill="#9ca3af" font-size="12">RRP &#8212; RevisionRootPage (revision anchor)</text>

  <rect x="130" y="472" width="18" height="10" rx="3" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="0.8"/>
  <text x="156" y="482" fill="#9ca3af" font-size="12">PF &#8212; Page Fragment (IndirPage, RecordPage, NamePage, ...)</text>

  <rect x="560" y="450" width="18" height="10" rx="3" fill="rgba(244,123,32,0.35)" stroke="#F47B20" stroke-width="0.8"/>
  <text x="586" y="460" fill="#9ca3af" font-size="12">UberPage entry (TSP + OFFS per revision)</text>

  <line x1="560" y1="477" x2="610" y2="477" stroke="#F47B20" stroke-width="1.2" stroke-dasharray="4,2"/>
  <text x="620" y="482" fill="#9ca3af" font-size="12">Offset pointer from LD₂ to RRP in LD₁</text>

  <!-- Note -->
  <text x="480" y="510" text-anchor="middle" fill="#6b7280" font-size="11">Each revision appends only modified page fragments (copy-on-write). The UberPage is written last to both files as an atomic commit.</text>
</svg>
