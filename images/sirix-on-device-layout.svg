<svg viewBox="0 0 960 500" fill="none" xmlns="http://www.w3.org/2000/svg" font-family="Inter,system-ui,sans-serif">
  <defs>
    <marker id="arrowOrange" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0,0 10,3.5 0,7" fill="#F47B20"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="480" y="28" text-anchor="middle" fill="#e8e6e3" font-size="18" font-weight="600">Logical Device Layout of a Resource</text>
  <text x="480" y="48" text-anchor="middle" fill="#9ca3af" font-size="12">How SirixDB stores versioned data on disk using two append-only files</text>

  <!-- ============================================ -->
  <!-- LD₂ — UberPage file                          -->
  <!-- ============================================ -->

  <!-- LD₂ label -->
  <rect x="25" y="78" width="55" height="80" rx="8" fill="rgba(156,163,175,0.08)" stroke="#6b7280" stroke-width="1.5"/>
  <text x="52" y="115" text-anchor="middle" fill="#9ca3af" font-size="14" font-family="JetBrains Mono,monospace" font-weight="600">LD₂</text>
  <text x="52" y="174" text-anchor="middle" fill="#6b7280" font-size="9">Revisions</text>

  <!-- LD₂ center line -->
  <line x1="95" y1="118" x2="910" y2="118" stroke="#6b7280" stroke-width="1" stroke-dasharray="4,3"/>

  <!-- H block (UberPage header) — first block of LD₂ -->
  <rect x="110" y="88" width="50" height="60" rx="5" fill="rgba(244,123,32,0.5)" stroke="#F47B20" stroke-width="1.5"/>
  <text x="135" y="122" text-anchor="middle" fill="#F47B20" font-size="14" font-family="JetBrains Mono,monospace" font-weight="700">H</text>

  <!-- TSP/OFFS entries — densely packed after H -->
  <rect x="170" y="88" width="60" height="60" rx="5" fill="rgba(244,123,32,0.25)" stroke="#F47B20" stroke-width="1"/>
  <text x="200" y="107" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">TSP₁</text>
  <text x="200" y="123" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">OFFS₁</text>
  <text x="200" y="141" text-anchor="middle" fill="#9ca3af" font-size="9">rev 1</text>

  <rect x="230" y="88" width="60" height="60" rx="5" fill="rgba(244,123,32,0.25)" stroke="#F47B20" stroke-width="1"/>
  <text x="260" y="107" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">TSP₂</text>
  <text x="260" y="123" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">OFFS₂</text>
  <text x="260" y="141" text-anchor="middle" fill="#9ca3af" font-size="9">rev 2</text>

  <rect x="290" y="88" width="60" height="60" rx="5" fill="rgba(244,123,32,0.25)" stroke="#F47B20" stroke-width="1"/>
  <text x="320" y="107" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">TSP₃</text>
  <text x="320" y="123" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">OFFS₃</text>
  <text x="320" y="141" text-anchor="middle" fill="#9ca3af" font-size="9">rev 3</text>

  <text x="370" y="122" fill="#6b7280" font-size="18" text-anchor="middle">...</text>

  <!-- Annotation: densely packed -->
  <text x="260" y="165" text-anchor="middle" fill="#6b7280" font-size="9" font-style="italic">densely packed (no block alignment)</text>

  <!-- ============================================ -->
  <!-- LD₁ — Data file                              -->
  <!-- ============================================ -->

  <!-- LD₁ label -->
  <rect x="25" y="230" width="55" height="120" rx="8" fill="rgba(156,163,175,0.08)" stroke="#6b7280" stroke-width="1.5"/>
  <text x="52" y="295" text-anchor="middle" fill="#9ca3af" font-size="14" font-family="JetBrains Mono,monospace" font-weight="600">LD₁</text>
  <text x="52" y="368" text-anchor="middle" fill="#6b7280" font-size="9">Data</text>

  <!-- LD₁ center line -->
  <line x1="95" y1="290" x2="910" y2="290" stroke="#6b7280" stroke-width="1" stroke-dasharray="4,3"/>

  <!-- H block (UberPage header) — first block of LD₁ -->
  <rect x="110" y="260" width="50" height="36" rx="5" fill="rgba(244,123,32,0.5)" stroke="#F47B20" stroke-width="1.5"/>
  <text x="135" y="283" text-anchor="middle" fill="#F47B20" font-size="14" font-family="JetBrains Mono,monospace" font-weight="700">H</text>

  <!-- === Revision 1 === -->

  <rect x="175" y="260" width="70" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="210" y="276" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PF₁,₁</text>
  <text x="210" y="290" text-anchor="middle" fill="#6b7280" font-size="9">IndirPage</text>

  <rect x="255" y="260" width="70" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="290" y="276" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PF₂,₁</text>
  <text x="290" y="290" text-anchor="middle" fill="#6b7280" font-size="9">RecordPage</text>

  <text x="338" y="282" fill="#42B6F0" font-size="14" text-anchor="middle" opacity="0.5">...</text>

  <rect x="350" y="260" width="70" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="385" y="276" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PFₙ,₁</text>
  <text x="385" y="290" text-anchor="middle" fill="#6b7280" font-size="9">NamePage</text>

  <!-- RRP₁ -->
  <rect x="430" y="254" width="55" height="48" rx="6" fill="rgba(244,123,32,0.55)" stroke="#F47B20" stroke-width="1.5"/>
  <text x="458" y="276" text-anchor="middle" fill="#F47B20" font-size="11" font-family="JetBrains Mono,monospace" font-weight="700">RRP</text>
  <text x="458" y="292" text-anchor="middle" fill="#e8e6e3" font-size="9">rev 1</text>

  <!-- === Revision 2 === -->

  <rect x="500" y="260" width="70" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="535" y="276" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PF₁,₂</text>
  <text x="535" y="290" text-anchor="middle" fill="#6b7280" font-size="9">RecordPage</text>

  <text x="583" y="282" fill="#42B6F0" font-size="14" text-anchor="middle" opacity="0.5">...</text>

  <rect x="595" y="260" width="70" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="630" y="276" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PF₂,₂</text>
  <text x="630" y="290" text-anchor="middle" fill="#6b7280" font-size="9">PathPage</text>

  <!-- RRP₂ -->
  <rect x="675" y="254" width="55" height="48" rx="6" fill="rgba(244,123,32,0.55)" stroke="#F47B20" stroke-width="1.5"/>
  <text x="703" y="276" text-anchor="middle" fill="#F47B20" font-size="11" font-family="JetBrains Mono,monospace" font-weight="700">RRP</text>
  <text x="703" y="292" text-anchor="middle" fill="#e8e6e3" font-size="9">rev 2</text>

  <!-- === Revision 3 === -->

  <rect x="745" y="260" width="70" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="780" y="276" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PF₁,₃</text>
  <text x="780" y="290" text-anchor="middle" fill="#6b7280" font-size="9">RecordPage</text>

  <!-- RRP₃ -->
  <rect x="825" y="254" width="55" height="48" rx="6" fill="rgba(244,123,32,0.55)" stroke="#F47B20" stroke-width="1.5"/>
  <text x="853" y="276" text-anchor="middle" fill="#F47B20" font-size="11" font-family="JetBrains Mono,monospace" font-weight="700">RRP</text>
  <text x="853" y="292" text-anchor="middle" fill="#e8e6e3" font-size="9">rev 3</text>

  <text x="898" y="282" fill="#6b7280" font-size="18" text-anchor="middle">...</text>

  <!-- Block size bracket for LD₁ (pages are block-aligned) -->
  <line x1="175" y1="302" x2="175" y2="310" stroke="#6b7280" stroke-width="0.8"/>
  <line x1="175" y1="310" x2="245" y2="310" stroke="#6b7280" stroke-width="0.8"/>
  <line x1="245" y1="302" x2="245" y2="310" stroke="#6b7280" stroke-width="0.8"/>
  <text x="210" y="322" text-anchor="middle" fill="#6b7280" font-size="9" font-family="JetBrains Mono,monospace">Blk</text>

  <!-- === Offset arrows from LD₂ OFFS → LD₁ RRP === -->

  <!-- OFFS₁ → RRP₁: down from (200,148) to (458,254) -->
  <path d="M 200 148 L 200 187 Q 200 195 208 195 L 450 195 Q 458 195 458 203 L 458 254"
        fill="none" stroke="#F47B20" stroke-width="1.3" stroke-dasharray="5,3" marker-end="url(#arrowOrange)"/>

  <!-- OFFS₂ → RRP₂: down from (260,148) to (703,254) -->
  <path d="M 260 148 L 260 199 Q 260 207 268 207 L 695 207 Q 703 207 703 215 L 703 254"
        fill="none" stroke="#F47B20" stroke-width="1.3" stroke-dasharray="5,3" marker-end="url(#arrowOrange)"/>

  <!-- OFFS₃ → RRP₃: down from (320,148) to (853,254) -->
  <path d="M 320 148 L 320 211 Q 320 219 328 219 L 845 219 Q 853 219 853 227 L 853 254"
        fill="none" stroke="#F47B20" stroke-width="1.3" stroke-dasharray="5,3" marker-end="url(#arrowOrange)"/>

  <!-- === Revision brackets === -->

  <line x1="175" y1="345" x2="485" y2="345" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="175" y1="340" x2="175" y2="350" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="485" y1="340" x2="485" y2="350" stroke="#42B6F0" stroke-width="1.5"/>
  <text x="330" y="365" text-anchor="middle" fill="#42B6F0" font-size="13" font-family="JetBrains Mono,monospace" font-weight="600">R₁</text>

  <line x1="500" y1="345" x2="730" y2="345" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="500" y1="340" x2="500" y2="350" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="730" y1="340" x2="730" y2="350" stroke="#42B6F0" stroke-width="1.5"/>
  <text x="615" y="365" text-anchor="middle" fill="#42B6F0" font-size="13" font-family="JetBrains Mono,monospace" font-weight="600">R₂</text>

  <line x1="745" y1="345" x2="880" y2="345" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="745" y1="340" x2="745" y2="350" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="880" y1="340" x2="880" y2="350" stroke="#42B6F0" stroke-width="1.5"/>
  <text x="813" y="365" text-anchor="middle" fill="#42B6F0" font-size="13" font-family="JetBrains Mono,monospace" font-weight="600">R₃</text>

  <!-- === Legend === -->

  <rect x="100" y="400" width="18" height="10" rx="3" fill="rgba(244,123,32,0.5)" stroke="#F47B20" stroke-width="0.8"/>
  <text x="126" y="410" fill="#9ca3af" font-size="11">H &#8212; UberPage header (first block of both files)</text>

  <rect x="100" y="420" width="18" height="10" rx="3" fill="rgba(244,123,32,0.55)" stroke="#F47B20" stroke-width="0.8"/>
  <text x="126" y="430" fill="#9ca3af" font-size="11">RRP &#8212; RevisionRootPage (revision anchor)</text>

  <rect x="530" y="400" width="18" height="10" rx="3" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="0.8"/>
  <text x="556" y="410" fill="#9ca3af" font-size="11">PF &#8212; Page Fragment (IndirPage, RecordPage, ...)</text>

  <rect x="530" y="420" width="18" height="10" rx="3" fill="rgba(244,123,32,0.25)" stroke="#F47B20" stroke-width="0.8"/>
  <text x="556" y="430" fill="#9ca3af" font-size="11">TSP + OFFS &#8212; Timestamp + offset per revision</text>

  <line x1="100" y1="445" x2="150" y2="445" stroke="#F47B20" stroke-width="1.3" stroke-dasharray="5,3"/>
  <text x="160" y="449" fill="#9ca3af" font-size="11">Offset pointer from LD₂ to RRP in LD₁</text>

  <!-- Footer note -->
  <text x="480" y="485" text-anchor="middle" fill="#6b7280" font-size="11">Each revision appends only modified page fragments (copy-on-write). The UberPage header is written last to both files as an atomic commit.</text>
</svg>
