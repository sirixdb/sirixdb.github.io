<svg viewBox="0 0 960 500" fill="none" xmlns="http://www.w3.org/2000/svg" font-family="Inter,system-ui,sans-serif">
  <defs>
    <marker id="arrowOrange" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0,0 10,3.5 0,7" fill="#F47B20"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="480" y="28" text-anchor="middle" fill="#e8e6e3" font-size="18" font-weight="600">Logical Device Layout of a Resource</text>
  <text x="480" y="48" text-anchor="middle" fill="#9ca3af" font-size="12">How SirixDB stores versioned data on disk using two append-only files</text>

  <!-- ============================================ -->
  <!-- LD₂ — Revisions file                         -->
  <!-- ============================================ -->

  <!-- LD₂ label -->
  <rect x="25" y="78" width="55" height="80" rx="8" fill="rgba(156,163,175,0.08)" stroke="#6b7280" stroke-width="1.5"/>
  <text x="52" y="115" text-anchor="middle" fill="#9ca3af" font-size="14" font-family="JetBrains Mono,monospace" font-weight="600">LD₂</text>
  <text x="52" y="175" text-anchor="middle" fill="#6b7280" font-size="9">Revisions</text>

  <!-- LD₂ baseline (below boxes) -->
  <line x1="95" y1="153" x2="910" y2="153" stroke="#6b7280" stroke-width="1" stroke-dasharray="4,3"/>

  <!-- H ×2 (UberPage header, stored twice) — first block of LD₂ -->
  <rect x="110" y="88" width="55" height="60" rx="5" fill="rgba(244,123,32,0.5)" stroke="#F47B20" stroke-width="1.5"/>
  <text x="137" y="116" text-anchor="middle" fill="#F47B20" font-size="13" font-family="JetBrains Mono,monospace" font-weight="700">H</text>
  <text x="137" y="133" text-anchor="middle" fill="#F47B20" font-size="9" font-family="JetBrains Mono,monospace">×2</text>

  <!-- TSP/OFFS entries — densely packed after H -->
  <rect x="175" y="88" width="58" height="60" rx="5" fill="rgba(244,123,32,0.25)" stroke="#F47B20" stroke-width="1"/>
  <text x="204" y="107" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">TSP₁</text>
  <text x="204" y="123" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">OFFS₁</text>
  <text x="204" y="141" text-anchor="middle" fill="#9ca3af" font-size="9">rev 1</text>

  <rect x="233" y="88" width="58" height="60" rx="5" fill="rgba(244,123,32,0.25)" stroke="#F47B20" stroke-width="1"/>
  <text x="262" y="107" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">TSP₂</text>
  <text x="262" y="123" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">OFFS₂</text>
  <text x="262" y="141" text-anchor="middle" fill="#9ca3af" font-size="9">rev 2</text>

  <rect x="291" y="88" width="58" height="60" rx="5" fill="rgba(244,123,32,0.25)" stroke="#F47B20" stroke-width="1"/>
  <text x="320" y="107" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">TSP₃</text>
  <text x="320" y="123" text-anchor="middle" fill="#F47B20" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">OFFS₃</text>
  <text x="320" y="141" text-anchor="middle" fill="#9ca3af" font-size="9">rev 3</text>

  <text x="368" y="122" fill="#6b7280" font-size="18" text-anchor="middle">...</text>

  <!-- Annotation: densely packed -->
  <text x="400" y="100" fill="#6b7280" font-size="9" font-style="italic">densely packed</text>
  <text x="400" y="112" fill="#6b7280" font-size="9" font-style="italic">(no block alignment)</text>

  <!-- ============================================ -->
  <!-- LD₁ — Data file                              -->
  <!-- ============================================ -->

  <!-- LD₁ label -->
  <rect x="25" y="245" width="55" height="105" rx="8" fill="rgba(156,163,175,0.08)" stroke="#6b7280" stroke-width="1.5"/>
  <text x="52" y="302" text-anchor="middle" fill="#9ca3af" font-size="14" font-family="JetBrains Mono,monospace" font-weight="600">LD₁</text>
  <text x="52" y="368" text-anchor="middle" fill="#6b7280" font-size="9">Data</text>

  <!-- LD₁ baseline (below Blk bracket) -->
  <line x1="95" y1="338" x2="910" y2="338" stroke="#6b7280" stroke-width="1" stroke-dasharray="4,3"/>

  <!-- H ×2 (UberPage header, stored twice) — first block of LD₁ -->
  <rect x="110" y="270" width="55" height="36" rx="5" fill="rgba(244,123,32,0.5)" stroke="#F47B20" stroke-width="1.5"/>
  <text x="137" y="290" text-anchor="middle" fill="#F47B20" font-size="13" font-family="JetBrains Mono,monospace" font-weight="700">H</text>
  <text x="137" y="302" text-anchor="middle" fill="#F47B20" font-size="9" font-family="JetBrains Mono,monospace">×2</text>

  <!-- === Revision 1 (bottom-up: RecordPage before IndirPage) === -->

  <rect x="180" y="270" width="68" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="214" y="286" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PF₁,₁</text>
  <text x="214" y="300" text-anchor="middle" fill="#6b7280" font-size="9">RecordPage</text>

  <text x="261" y="292" fill="#42B6F0" font-size="14" text-anchor="middle" opacity="0.5">...</text>

  <rect x="275" y="270" width="68" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="309" y="286" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PFₙ,₁</text>
  <text x="309" y="300" text-anchor="middle" fill="#6b7280" font-size="9">IndirPage</text>

  <!-- RRP₁ -->
  <rect x="353" y="264" width="55" height="48" rx="6" fill="rgba(244,123,32,0.55)" stroke="#F47B20" stroke-width="1.5"/>
  <text x="380" y="286" text-anchor="middle" fill="#F47B20" font-size="11" font-family="JetBrains Mono,monospace" font-weight="700">RRP</text>
  <text x="380" y="302" text-anchor="middle" fill="#e8e6e3" font-size="9">rev 1</text>

  <!-- === Revision 2 === -->

  <rect x="423" y="270" width="68" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="457" y="286" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PF₁,₂</text>
  <text x="457" y="300" text-anchor="middle" fill="#6b7280" font-size="9">RecordPage</text>

  <text x="504" y="292" fill="#42B6F0" font-size="14" text-anchor="middle" opacity="0.5">...</text>

  <rect x="518" y="270" width="68" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="552" y="286" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PF₂,₂</text>
  <text x="552" y="300" text-anchor="middle" fill="#6b7280" font-size="9">PathPage</text>

  <!-- RRP₂ -->
  <rect x="596" y="264" width="55" height="48" rx="6" fill="rgba(244,123,32,0.55)" stroke="#F47B20" stroke-width="1.5"/>
  <text x="623" y="286" text-anchor="middle" fill="#F47B20" font-size="11" font-family="JetBrains Mono,monospace" font-weight="700">RRP</text>
  <text x="623" y="302" text-anchor="middle" fill="#e8e6e3" font-size="9">rev 2</text>

  <!-- === Revision 3 === -->

  <rect x="666" y="270" width="68" height="36" rx="5" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="1"/>
  <text x="700" y="286" text-anchor="middle" fill="#42B6F0" font-size="10" font-family="JetBrains Mono,monospace" font-weight="600">PF₁,₃</text>
  <text x="700" y="300" text-anchor="middle" fill="#6b7280" font-size="9">RecordPage</text>

  <!-- RRP₃ -->
  <rect x="744" y="264" width="55" height="48" rx="6" fill="rgba(244,123,32,0.55)" stroke="#F47B20" stroke-width="1.5"/>
  <text x="771" y="286" text-anchor="middle" fill="#F47B20" font-size="11" font-family="JetBrains Mono,monospace" font-weight="700">RRP</text>
  <text x="771" y="302" text-anchor="middle" fill="#e8e6e3" font-size="9">rev 3</text>

  <text x="815" y="292" fill="#6b7280" font-size="18" text-anchor="middle">...</text>

  <!-- Block size bracket for LD₁ -->
  <line x1="180" y1="312" x2="180" y2="320" stroke="#6b7280" stroke-width="0.8"/>
  <line x1="180" y1="320" x2="248" y2="320" stroke="#6b7280" stroke-width="0.8"/>
  <line x1="248" y1="312" x2="248" y2="320" stroke="#6b7280" stroke-width="0.8"/>
  <text x="214" y="332" text-anchor="middle" fill="#6b7280" font-size="9" font-family="JetBrains Mono,monospace">Blk</text>

  <!-- === Offset arrows: smooth bezier curves from OFFS → RRP === -->
  <!-- Curves arc through the empty gap, never crossing elements -->

  <!-- OFFS₁ → RRP₁ -->
  <path d="M 204 148 C 204 220, 380 180, 380 264"
        fill="none" stroke="#F47B20" stroke-width="1.2" stroke-dasharray="5,3" opacity="0.7" marker-end="url(#arrowOrange)"/>

  <!-- OFFS₂ → RRP₂ -->
  <path d="M 262 148 C 262 220, 623 180, 623 264"
        fill="none" stroke="#F47B20" stroke-width="1.2" stroke-dasharray="5,3" opacity="0.7" marker-end="url(#arrowOrange)"/>

  <!-- OFFS₃ → RRP₃ -->
  <path d="M 320 148 C 320 220, 771 180, 771 264"
        fill="none" stroke="#F47B20" stroke-width="1.2" stroke-dasharray="5,3" opacity="0.7" marker-end="url(#arrowOrange)"/>

  <!-- === Revision brackets === -->

  <line x1="180" y1="350" x2="408" y2="350" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="180" y1="345" x2="180" y2="355" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="408" y1="345" x2="408" y2="355" stroke="#42B6F0" stroke-width="1.5"/>
  <text x="294" y="370" text-anchor="middle" fill="#42B6F0" font-size="13" font-family="JetBrains Mono,monospace" font-weight="600">R₁</text>

  <line x1="423" y1="350" x2="651" y2="350" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="423" y1="345" x2="423" y2="355" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="651" y1="345" x2="651" y2="355" stroke="#42B6F0" stroke-width="1.5"/>
  <text x="537" y="370" text-anchor="middle" fill="#42B6F0" font-size="13" font-family="JetBrains Mono,monospace" font-weight="600">R₂</text>

  <line x1="666" y1="350" x2="799" y2="350" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="666" y1="345" x2="666" y2="355" stroke="#42B6F0" stroke-width="1.5"/>
  <line x1="799" y1="345" x2="799" y2="355" stroke="#42B6F0" stroke-width="1.5"/>
  <text x="733" y="370" text-anchor="middle" fill="#42B6F0" font-size="13" font-family="JetBrains Mono,monospace" font-weight="600">R₃</text>

  <!-- === Legend === -->

  <rect x="100" y="400" width="18" height="10" rx="3" fill="rgba(244,123,32,0.5)" stroke="#F47B20" stroke-width="0.8"/>
  <text x="126" y="410" fill="#9ca3af" font-size="11">H ×2 &#8212; UberPage header (stored twice, first block of both files)</text>

  <rect x="100" y="420" width="18" height="10" rx="3" fill="rgba(244,123,32,0.55)" stroke="#F47B20" stroke-width="0.8"/>
  <text x="126" y="430" fill="#9ca3af" font-size="11">RRP &#8212; RevisionRootPage (revision anchor)</text>

  <rect x="560" y="400" width="18" height="10" rx="3" fill="rgba(66,182,240,0.2)" stroke="#42B6F0" stroke-width="0.8"/>
  <text x="586" y="410" fill="#9ca3af" font-size="11">PF &#8212; Page Fragment (RecordPage, IndirPage, ...)</text>

  <rect x="560" y="420" width="18" height="10" rx="3" fill="rgba(244,123,32,0.25)" stroke="#F47B20" stroke-width="0.8"/>
  <text x="586" y="430" fill="#9ca3af" font-size="11">TSP + OFFS &#8212; Timestamp + offset per revision</text>

  <line x1="100" y1="448" x2="150" y2="448" stroke="#F47B20" stroke-width="1.2" stroke-dasharray="5,3" opacity="0.7"/>
  <text x="160" y="452" fill="#9ca3af" font-size="11">Offset pointer from LD₂ to RRP in LD₁</text>

  <!-- Footer note -->
  <text x="480" y="485" text-anchor="middle" fill="#6b7280" font-size="11">Pages written bottom-up (RecordPages first, then IndirPages). The UberPage header is written last to both files as an atomic commit.</text>
</svg>
